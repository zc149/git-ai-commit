# v0.2.0: AI ì¶”ì²œ ì‹œìŠ¤í…œ ê°œì„ 

## ë²„ì „ ì •ë³´
- **ë²„ì „**: 0.2.0
- **ë‚ ì§œ**: 2025-02-06
- **ëª©í‘œ**: ì»¤ë°‹ íƒ€ì… ë° Scope ì¶”ì²œ ì •í™•ë„ í–¥ìƒ

## ë¬¸ì œì 

### 1. ì»¤ë°‹ íƒ€ì… ë¶„ë¥˜ ì˜¤ë¥˜
**ì‚¬ìš©ì í”¼ë“œë°±**:
```
feat: add api-proxy-backed plugin ìœ¼ë¡œ ë‚´ê°€ ì§ì ‘ ì»¤ë°‹

ğŸ“Š Recommended commit type: build
   Recommended scope: [app-config.local.yaml app-config.yaml packages plugins yarn.lock]
```

ìƒˆë¡œìš´ í”ŒëŸ¬ê·¸ì¸ ì¶”ê°€ê°€ `build`ë¡œ ë¶„ë¥˜ë˜ëŠ” ë¬¸ì œ

### 2. Scope ê³¼ë„í•œ íŒŒì¼ ë‚˜ì—´
ì—¬ëŸ¬ ë””ë ‰í† ë¦¬ ë³€ê²½ ì‹œ ëª¨ë“  íŒŒì¼ ì´ë¦„ì„ ë‚˜ì—´:
```
[app-config.local.yaml app-config.yaml packages plugins yarn.lock]
```
`api-proxy-backend`ì²˜ëŸ¼ ê°„ê²°í•œ scopeê°€ í•„ìš”

## ì›ì¸ ë¶„ì„

### ì»¤ë°‹ íƒ€ì… ë¶„ë¥˜ ì˜¤ë¥˜ ì›ì¸
- ë‹¨ìˆœ íŒŒì¼ ê°œìˆ˜ ë¹„êµë§Œìœ¼ë¡œëŠ” ì»¤ë°‹ íƒ€ì… íŒë‹¨ ë¶ˆê°€
- ìƒˆë¡œìš´ ì†ŒìŠ¤ íŒŒì¼ì´ ë‹¤ìˆ˜ ì¶”ê°€ë˜ì—ˆìŒì—ë„ `build` íƒ€ì… ë¶„ë¥˜
- íŒŒì¼ ìœ í˜•(source/config/test)ê³¼ ë³€ê²½ ìœ í˜•(new/deleted/modified) ë¶„ì„ ë¶€ì¡±

### Scope ê³¼ë„í•œ íŒŒì¼ ë‚˜ì—´ ì›ì¸
- ì—¬ëŸ¬ ë””ë ‰í† ë¦¬ ë³€ê²½ ì‹œ ê³µí†µ ê²½ë¡œ ì¶”ì¶œ ë¡œì§ ë¶€ì¬
- fallback ë¡œì§ì´ ëª¨ë“  íŒŒì¼ ì´ë¦„ì„ ë‚˜ì—´í•˜ë„ë¡ êµ¬í˜„ë¨
- ìµœìƒìœ„ ë””ë ‰í† ë¦¬ê°€ ê°™ì„ ë•Œ êµ¬ì²´ì ì¸ í•˜ìœ„ ê²½ë¡œ ì¶”ì¶œ ì‹¤íŒ¨

## í•´ê²° ë°©ì•ˆ

### 1. InferCommitType í•¨ìˆ˜ êµ¬í˜„

**íŒŒì¼**: `internal/git/diff.go`

```go
func InferCommitType(files []git.FileChange) string {
    if len(files) == 0 {
        return "chore"
    }

    // íŒŒì¼ ìœ í˜• ë° ë³€ê²½ ìœ í˜• ë¶„ì„
    sourceFiles := 0
    configFiles := 0
    newSourceFiles := 0
    deletedFiles := 0
    hasDependencyChanges := false

    for _, file := range files {
        if file.IsDeleted {
            deletedFiles++
        }

        switch file.FileType {
        case git.FileTypeSource:
            sourceFiles++
            if file.IsNew {
                newSourceFiles++
            }
        case git.FileTypeConfig:
            configFiles++
            // ì˜ì¡´ì„± íŒŒì¼ í™•ì¸
            if strings.Contains(file.Path, "package.json") ||
                strings.Contains(file.Path, "go.mod") ||
                strings.Contains(file.Path, "requirements.txt") ||
                strings.Contains(file.Path, "pom.xml") ||
                strings.Contains(file.Path, "Cargo.toml") ||
                strings.Contains(file.Path, "yarn.lock") ||
                strings.Contains(file.Path, "package-lock.json") {
                hasDependencyChanges = true
            }
        }
    }

    // ìš°ì„ ìˆœìœ„ì— ë”°ë¥¸ íƒ€ì… ê²°ì •
    // 1. ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€ (3ê°œ ì´ìƒì˜ ìƒˆ ì†ŒìŠ¤ íŒŒì¼)
    if newSourceFiles >= 3 {
        return "feat"
    }

    // 2. ì˜ì¡´ì„± ë³€ê²½
    if hasDependencyChanges && (configFiles >= sourceFiles) {
        return "build"
    }

    // 3. ì†ŒìŠ¤ íŒŒì¼ ìˆ˜ì • (ìƒˆ íŒŒì¼ ì—†ìŒ)
    if sourceFiles > 0 && newSourceFiles == 0 {
        // íŒŒì¼ ë³€ê²½ ë‚´ìš©ì—ì„œ ë²„ê·¸ ê´€ë ¨ í‚¤ì›Œë“œ í™•ì¸
        for _, file := range files {
            if strings.Contains(strings.ToLower(file.Changes), "fix") ||
                strings.Contains(strings.ToLower(file.Changes), "bug") ||
                strings.Contains(strings.ToLower(file.Changes), "error") ||
                strings.Contains(strings.ToLower(file.Changes), "patch") {
                return "fix"
            }
        }
        // ë²„ê·¸ ê´€ë ¨ í‚¤ì›Œë“œê°€ ì—†ìœ¼ë©´ refactorë¡œ ê°„ì£¼
        return "refactor"
    }

    // 4. íŒŒì¼ ì‚­ì œ
    if deletedFiles > 0 && sourceFiles == 0 {
        return "chore"
    }

    // 5. ì„¤ì • íŒŒì¼ë§Œ ë³€ê²½
    if configFiles > 0 && sourceFiles == 0 {
        return "build"
    }

    return "chore"
}
```

**íŠ¹ì§•**:
- ìƒˆë¡œìš´ ì†ŒìŠ¤ íŒŒì¼ì´ 3ê°œ ì´ìƒì¼ ë•Œ `feat` íƒ€ì…
- ì˜ì¡´ì„± íŒŒì¼ ë³€ê²½ ì‹œ `build` íƒ€ì…
- ë²„ê·¸ ê´€ë ¨ í‚¤ì›Œë“œ ê°ì§€ ì‹œ `fix` íƒ€ì…
- íŒŒì¼ ìœ í˜•ë³„ ê°€ì¤‘ì¹˜ ë¶„ì„

### 2. InferScopes í•¨ìˆ˜ êµ¬í˜„

**íŒŒì¼**: `internal/git/diff.go`

```go
func InferScopes(files []git.FileChange) []string {
    if len(files) == 0 {
        return []string{}
    }

    // ëª¨ë“  íŒŒì¼ ê²½ë¡œ ìˆ˜ì§‘
    paths := make([]string, 0, len(files))
    for _, file := range files {
        paths = append(paths, file.Path)
    }

    // ê°€ì¥ ê¸´ ê³µí†µ ê²½ë¡œ ì°¾ê¸°
    commonPrefix := findCommonPrefix(paths)

    if commonPrefix == "" {
        // ê³µí†µ ê²½ë¡œê°€ ì—†ìœ¼ë©´ ì²« ë²ˆì§¸ íŒŒì¼ì˜ ìµœìƒìœ„ ë””ë ‰í† ë¦¬ ì‚¬ìš©
        parts := strings.Split(files[0].Path, string([]string{"/", "\\"})[0])
        if len(parts) > 1 {
            return []string{parts[0]}
        }
        return []string{}
    }

    // ê³µí†µ ê²½ë¡œë¥¼ ë¶„ë¦¬í•˜ì—¬ scope ê²°ì •
    parts := strings.Split(commonPrefix, string([]string{"/", "\\"})[0])

    // 1ë‹¨ê³„: ì „ì²´ ê²½ë¡œ ì‚¬ìš© (ì˜ˆ: plugins/auth)
    if len(parts) >= 2 {
        scope := strings.Join(parts, "/")
        return []string{scope}
    }

    // 2ë‹¨ê³„: ë‹¨ì¼ ë””ë ‰í† ë¦¬
    if len(parts) == 1 {
        return []string{parts[0]}
    }

    return []string{}
}

func findCommonPrefix(paths []string) string {
    if len(paths) == 0 {
        return ""
    }

    if len(paths) == 1 {
        return paths[0]
    }

    // êµ¬ë¶„ì í‘œì¤€í™”
    normalized := make([]string, len(paths))
    for i, path := range paths {
        normalized[i] = strings.ReplaceAll(path, "\\", "/")
    }

    // ì²« ë²ˆì§¸ ê²½ë¡œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë¹„êµ
    first := normalized[0]
    minLen := len(first)

    for i := 1; i < len(normalized); i++ {
        if len(normalized[i]) < minLen {
            minLen = len(normalized[i])
        }
    }

    commonPrefix := ""
    for i := 0; i < minLen; i++ {
        char := first[i]
        allMatch := true
        for j := 1; j < len(normalized); j++ {
            if normalized[j][i] != char {
                allMatch = false
                break
            }
        }
        if !allMatch {
            break
        }
        commonPrefix += string(char)
    }

    // ë§ˆì§€ë§‰ì´ ë””ë ‰í† ë¦¬ êµ¬ë¶„ìì´ë©´ ì œê±°
    if strings.HasSuffix(commonPrefix, "/") {
        commonPrefix = commonPrefix[:len(commonPrefix)-1]
    }

    // ê³µí†µ ê²½ë¡œë¥¼ ë§ˆì§€ë§‰ êµ¬ë¶„ìê¹Œì§€ ì˜ë¼ë‚´ê¸°
    lastSeparator := strings.LastIndex(commonPrefix, "/")
    if lastSeparator != -1 {
        return commonPrefix[:lastSeparator]
    }

    return ""
}
```

**íŠ¹ì§•**:
- ê°€ì¥ ê¸´ ê³µí†µ ë””ë ‰í† ë¦¬ ê²½ë¡œ ì‚¬ìš©
- ë‹¨ì¼ scope ìš°ì„ 
- path êµ¬ë¶„ì í˜¸í™˜ (`/`, `\`)

### 3. í”„ë¡¬í”„íŠ¸ ê°•í™”

**íŒŒì¼**: `internal/core/prompt.go`

#### 3.1 ì»¤ë°‹ íƒ€ì… ì„¤ëª… ì¶”ê°€

```go
func getCommitTypeDescription(commitType string, lang string) string {
    descriptions := map[string]map[string]string{
        "feat": {
            "ko": "ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€",
            "en": "New feature addition",
        },
        "fix": {
            "ko": "ë²„ê·¸ ìˆ˜ì •",
            "en": "Bug fix",
        },
        "build": {
            "ko": "ë¹Œë“œ ì‹œìŠ¤í…œ ë˜ëŠ” ì˜ì¡´ì„± ë³€ê²½",
            "en": "Build system or dependency changes",
        },
        // ... ê¸°íƒ€ íƒ€ì…
    }
    // ...
}
```

**ì¶œë ¥ ì˜ˆì‹œ**:
```
ì¶”ì²œ íƒ€ì…: feat (ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€)
```

#### 3.2 ë³€ê²½ íŒ¨í„´ ë¶„ì„ ì¶”ê°€

```go
func analyzeChangePattern(files []git.FileChange, lang string) string {
    // íŒŒì¼ ìœ í˜• ë° ë³€ê²½ ìœ í˜• ë¶„ì„
    newFiles := 0
    deletedFiles := 0
    sourceFiles := 0
    configFiles := 0
    testFiles := 0

    for _, file := range files {
        if file.IsNew {
            newFiles++
        }
        if file.IsDeleted {
            deletedFiles++
        }
        // ... íŒŒì¼ ìœ í˜• ë¶„ì„
    }

    // ë³€ê²½ íŒ¨í„´ ê²°ì •
    if newFiles > 0 && deletedFiles == 0 && sourceFiles >= 3 {
        if lang == "ko" {
            return "ìƒˆë¡œìš´ ê¸°ëŠ¥/ëª¨ë“ˆ ì¶”ê°€"
        } else {
            return "New feature/module addition"
        }
    } else if deletedFiles > 0 {
        // ... ê¸°íƒ€ íŒ¨í„´
    }
    // ...
}
```

**ì¶œë ¥ ì˜ˆì‹œ**:
```
ë³€ê²½ íŒ¨í„´: ìƒˆë¡œìš´ ê¸°ëŠ¥/ëª¨ë“ˆ ì¶”ê°€
```

#### 3.3 ë””ë ‰í† ë¦¬ êµ¬ì¡° ë¶„ì„ ì¶”ê°€

```go
func analyzeDirectoryStructure(files []git.FileChange, lang string) string {
    dirStats := make(map[string]*dirInfo)

    for _, file := range files {
        parts := strings.Split(file.Path, "/")
        dir := parts[0]
        // ... ë””ë ‰í† ë¦¬ë³„ íŒŒì¼ ìœ í˜• ì§‘ê³„
    }

    // ê²°ê³¼ ìƒì„±
    for dir, info := range dirStats {
        if lang == "ko" {
            builder.WriteString(fmt.Sprintf(
                "- %s: ì´ %dê°œ (ì†ŒìŠ¤: %d, ì„¤ì •: %d, í…ŒìŠ¤íŠ¸: %d, ë¬¸ì„œ: %d, ìƒˆ íŒŒì¼: %d)\n",
                dir, info.total, info.source, info.config, info.test, info.doc, info.newFiles))
        }
    }

    return builder.String()
}
```

**ì¶œë ¥ ì˜ˆì‹œ**:
```
ë””ë ‰í† ë¦¬ êµ¬ì¡°:
- plugins: ì´ 5ê°œ (ì†ŒìŠ¤: 5, ì„¤ì •: 0, í…ŒìŠ¤íŠ¸: 0, ë¬¸ì„œ: 0, ìƒˆ íŒŒì¼: 5)
- packages: ì´ 3ê°œ (ì†ŒìŠ¤: 2, ì„¤ì •: 1, í…ŒìŠ¤íŠ¸: 0, ë¬¸ì„œ: 0, ìƒˆ íŒŒì¼: 1)
```

## ê²°ê³¼

### 1. ì»¤ë°‹ íƒ€ì… ì •í™•ë„ í–¥ìƒ
**ì´ì „**:
```
feat: add api-proxy-backend plugin â†’ build íƒ€ì… ë¶„ë¥˜ (ì˜¤ë¥˜)
```

**ê°œì„  í›„**:
```
feat: add api-proxy-backend plugin â†’ feat íƒ€ì… ë¶„ë¥˜ (ì •í™•)
```

### 2. Scope ê°„ê²°í™”
**ì´ì „**:
```
[app-config.local.yaml app-config.yaml packages plugins yarn.lock]
```

**ê°œì„  í›„**:
```
api-proxy-backend
```

### 3. LLM íŒë‹¨ ê°œì„ 
- ì¶”ì²œ íƒ€ì… + ì„¤ëª… ì œê³µìœ¼ë¡œ LLM ì´í•´ë„ í–¥ìƒ
- ë³€ê²½ íŒ¨í„´ ë¶„ì„ìœ¼ë¡œ ì»¨í…ìŠ¤íŠ¸ ê°•í™”
- ë””ë ‰í† ë¦¬ êµ¬ì¡° ë¶„ì„ìœ¼ë¡œ ë²”ìœ„ ëª…í™•í™”

## ê´€ë ¨ íŒŒì¼ ë³€ê²½

### `internal/git/diff.go`
- **ì¶”ê°€**: `InferCommitType()` - ì»¤ë°‹ íƒ€ì… ì¶”ë¡ 
- **ì¶”ê°€**: `InferScopes()` - Scope ì¶”ë¡ 
- **ì¶”ê°€**: `findCommonPrefix()` - ê³µí†µ ê²½ë¡œ ì°¾ê¸°

### `internal/core/prompt.go`
- **ìˆ˜ì •**: `GeneratePrompt()` - í”„ë¡¬í”„íŠ¸ êµ¬ì¡° ê°•í™”
- **ì¶”ê°€**: `getCommitTypeDescription()` - íƒ€ì… ì„¤ëª… ë°˜í™˜
- **ì¶”ê°€**: `analyzeChangePattern()` - ë³€ê²½ íŒ¨í„´ ë¶„ì„
- **ì¶”ê°€**: `analyzeDirectoryStructure()` - ë””ë ‰í† ë¦¬ êµ¬ì¡° ë¶„ì„

## ë‹¤ìŒ ê°œì„ ì 

- [ ] ë³€ê²½ëœ í•¨ìˆ˜/í´ë˜ìŠ¤ ëª…ì‹œ (diffì—ì„œ import/export í•¨ìˆ˜ ì¶”ì )
- [ ] ì„±ëŠ¥ ë©”íŠ¸ë¦­ ì¶”ê°€ (í† í° ìˆ˜, ì‘ë‹µ ì‹œê°„)
- [ ] A/B í…ŒìŠ¤íŠ¸ ê²°ê³¼ ìˆ˜ì§‘ (ì‚¬ìš©ì í”¼ë“œë°±)
- [ ] ë” ë‹¤ì–‘í•œ ì—£ì§€ ì¼€ì´ìŠ¤ í…ŒìŠ¤íŠ¸
- [ ] ì‚¬ìš©ì ì •ì˜ íƒ€ì…/ìŠ¤ì½”ì–´ ê·œì¹™ ì§€ì›

## íšŒê³ 

### ì˜í•œ ì 
- âœ… í•˜ì´ë¸Œë¦¬ë“œ ì ‘ê·¼: ê·œì¹™ ê¸°ë°˜ ì¶”ë¡  + AI ìµœì¢… íŒë‹¨
- âœ… ì‚¬ìš©ì í”¼ë“œë°± ì¦‰ì‹œ ë°˜ì˜
- âœ… ì ì§„ì  ê°œì„  (ë‹¨ê³„ë³„ êµ¬í˜„)

### ê°œì„ í•  ì 
- âš ï¸ ì—£ì§€ ì¼€ì´ìŠ¤ í…ŒìŠ¤íŠ¸ ë” í•„ìš”
- âš ï¸ ì„±ëŠ¥ ìµœì í™” (ëŒ€ê·œëª¨ ë ˆí¬ì§€í† ë¦¬)
- âš ï¸ ì‚¬ìš©ì ì •ì˜ ê·œì¹™ ì§€ì›

### í•™ìŠµí•œ ì 
- ğŸ“š LLMì— ë” í’ë¶€í•œ ì»¨í…ìŠ¤íŠ¸ ì œê³µì´ íš¨ê³¼ì 
- ğŸ“š í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ì˜ ì¤‘ìš”ì„±
- ğŸ“š ì‚¬ìš©ì í”¼ë“œë°± ì£¼ê¸°ê°€ ë¹ ë¥¼ìˆ˜ë¡ ì¢‹ìŒ

## ì°¸ê³ 

### ì‚¬ìš©ì í”¼ë“œë°± ì›ë¬¸
```
1. ê¸°ëŠ¥ ì¶”ê°€ë¡œ feat: ê°€ ë” ì¤‘ìš”í•œ ì»¤ë°‹ì¸ë° build ë¡œ ë¶„ë¥˜ëŒ, 
   ê°™ì€ í´ë”ì— ì—†ì„ë•Œ ê´„í˜¸ì•ˆì— ëª¨ë“  íŒŒì¼ì˜ ì´ë¦„ì„ ì‘ì„±í•´ë²„ë¦¼..
   
   : feat: add api-proxy-backed plugin ìœ¼ë¡œ ë‚´ê°€ ì§ì ‘ ì»¤ë°‹
   
   ğŸ“Š Recommended commit type: build
      Recommended scope: [app-config.local.yaml app-config.yaml packages plugins yarn.lock]
   
   ì •í™•ì„±ì´ ë¶€ì¡±í•œëŠë‚Œì´ì•¼
```

### ê´€ë ¨ ì»¤ë°‹
- `c5c3a54`: fix(diff): Refactor diff.go for improved performance
- `ad6ae4e`: Initial commit for AI recommendation improvement